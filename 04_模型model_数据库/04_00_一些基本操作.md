

# 1 锁

**乐观锁**

概念：同一条数据很少会因为并发修改而产生冲突，适用于读多写少的场景。

实现方式：读取一个字段，执行处理逻辑，当需要更新数据时，再次检查该字段是否和第一次读取一致。如果一致，更新数据，否则不更新，重新读取后再提交。

**悲观锁**

概念：当一条数据正在被修改时，不允许其他任何关于这条数据的操作。
实现方式：读取一个字段之后，加锁，不允许其他任何读、写操作。执行处理逻辑，更新数据完毕后，释放锁。

**二者比较**

乐观锁的开销远低于悲观锁

原因：当 A 锁定了 a 资源，需要 b 资源。而 b 被 B 锁定，正在等待 a 资源。此时，导致出现死锁。也可以通过设置超时来处理这个问题。

悲观锁可以有效降低冲突后，重试的次数
乐观锁可以提高响应速度
在并发比较少时，建议使用乐观锁，减少加锁、释放锁的开销，在并发比较高的时候，建议使用悲观锁。


